<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex,noarchive">
	<meta name="generator" content="Nette Tester">

	<title><?php echo $title ? htmlSpecialChars("$title - ") : ''; ?>Code coverage</title>

	<style type="text/css">
	html {
		font: 16px/1.5 sans-serif;
		border-top: 4.7em solid #F4EBDB;
	}

	body {
		max-width: 990px;
		margin: -4.7em auto 0;
		background: white;
		color: #333;
		overflow-y: scroll;
		overflow-x: hidden;
	}

	h1 {
		font-size: 1.9em;
		margin: .5em 0 1.5em;
		color: #7A7772;
		text-shadow: 1px 1px 0 white;
	}

	.file {
		display: none;
		font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
		font-size: 12px;
		color: #333;
		word-wrap: normal;
		width: 1000px;
		overflow: hidden;
	}

	.lines {
		float: left;

		width: 50px;
		white-space: nowrap;
		font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
		font-size: 12px;
		line-height: 18px;
		color: rgba(0, 0, 0, 0.3);
		vertical-align: top;
		text-align: right;
		border: solid #eee;

		border-width: 0 1px 0 0;
		-webkit-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
		padding-left: 10px;
		padding-right: 10px
	}

	.source {
		float: left;
		padding-left: 10px;
		width: 90%;
		width: calc(100% - 83px);
		white-space: nowrap;
		line-height: 18px;
	}

	.clear {
		clear: both;
	}

	.color {
		position: absolute;
		display: block;
		height: 18px;
		width: 1000px;
		z-index: -1;
	}

	.t {
		background: #E6FFE5;
	}

	.u {
		background: #FFECEC;
	}

	td {
		vertical-align: middle;
	}

	small {
		color: gray;
	}

	.number {
		text-align: right;
		width: 50px;
	}

	.bar {
		border: 1px solid #ACACAC;
		background: #e50400;
		width: 35px;
		height: 1em;
	}

	.bar div {
		background: #1A7E1E;
		height: 1em;
	}

	.light td {
		opacity: .5;
	}

	.light td * {
		color: gray;
	}

	.not-loaded td * {
		color: red;
	}
	</style>
</head>

<body>
	<h1><?php echo $title ? htmlSpecialChars("$title - ") : ''; ?>Code coverage <?php echo $totalSum ? round($coveredSum * 100 / $totalSum) : 0 ?>&nbsp;%</h1>

	<?php foreach ($files as $id => $info): ?>
	<div>
		<table>
		<tr<?php echo $info->class ? " class='$info->class'" : '' ?>>
			<td class="number"><small><?php echo $info->coverage ?> %</small></td>
			<td><div class="bar"><div style="width: <?php echo $info->coverage ?>%"></div></div></td>
			<td><a href="#fragment<?php echo $id ?>" onclick="toggle(this); return false"><span><?php echo $info->name ?></span></a></td>
		</tr>
		</table>

		<div class="file" id="fragment<?php echo $id ?>">
			<div class="lines">
				<?php
					$source = highlight_file($info->file, TRUE);
					$lineCount = count(explode('<br />', $source));

					$prevColor = NULL;
					for ($n = 1; $n < $lineCount; ++$n) {
						if (isset($info->lines[$n]) && isset($classes[$info->lines[$n]])) {
							$color = $classes[$info->lines[$n]];
						} else {
							$color = '';  // not executable
						}
						if (!$prevColor) {
							$prevColor = $color;
						}

						if ($color) {
							echo "<div class=\"color $color\"></div>";
						}
						echo "$n<br />";
					}
				?>
			</div>
			<div class="source">
				<?php echo $source ?>
			</div>
		</div>
		<div class="clear"></div>
	</div>
	<?php endforeach ?>

	<footer>
		<p>Generated by <a href="http://tester.nette.org">Nette Tester</a> at <?php echo @date('Y/m/d H:i:s') // @ timezone may not be set ?></p>
	</footer>

	<script>
	function toggle(link) {
		var el = document.getElementById(link.href.split('#')[1]);
		if (el.style.display === 'block') {
			el.style.display = 'none';
			return false;
		} else {
			el.style.display = 'block';
		}
	}
	</script>
</body>
</html>
